# 14.2 快速查找

追踪集合成员关系...

Hug教授对快速查找的解释

---


### 集合列表

直觉上，我们可能首先考虑用集合列表表示不相交集合，例如`List<Set<Integer>>`。

当存在N=6个元素且尚未建立连接时，集合列表呈现为：`[{0}, {1}, {2}, {3}, {4}, {5}, {6}]`。这种表示看似合理，但在执行`connect(5, 6)`操作时，需要遍历最多N个集合来定位5和6，时间复杂度达到O(N)。实际代码实现也会非常复杂。

> 关键启示在于：**初始设计决策决定代码复杂度与运行时效率**。

---

### 快速查找

我们采用整数数组实现新方案：
- 数组索引代表集合元素
- 索引处的值表示所属集合编号

示例：`{0, 1, 2, 4}, {3, 5}, {6}`可表示为：

![](https://cs61b-2.gitbook.io/~gitbook/image?url=https%3A%2F%2F2316889115-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FCLYj7ccqvV6l4Pt9R0w5%252Fuploads%252FhbKp07TfM6BGDUoJ5w7D%252Fimage.png%3Falt%3Dmedia%26token%3D1242953a-0b42-4ca2-9d2d-c9c4e5e12b76&width=768&dpr=4&quality=100&sign=36fd8d59&sv=2)

集合4：{0, 1, 2, 4} | 集合5：{3, 5} | 集合6：{6}

_只要同集合元素共享相同编号，具体集合数值无关紧要。_

---

### connect(x, y)

操作演示：当`id[2] = 4`且`id[3] = 5`时，执行`connect(2, 3)`会将所有编号4和5的元素统一为5：

![](https://cs61b-2.gitbook.io/~gitbook/image?url=https%3A%2F%2F2316889115-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FCLYj7ccqvV6l4Pt9R0w5%252Fuploads%252F8wgaJLZGOKYIbMeP5uiI%252Fimage.png%3Falt%3Dmedia%26token%3Dc0eda17a-7255-4eb2-bfd6-cf1c6153f812&width=768&dpr=4&quality=100&sign=154fb4d7&sv=2)

集合5：{0, 1, 2, 3, 4, 5} | 集合6：{6}

`**isConnected(x, y)**`

通过判断`id[x] == id[y]`实现连接检测（常数时间复杂度），故称"快速查找"。

---

### 代码与时间复杂度

```markdown
public class QuickFindDS implements DisjointSets {

    private int[] id;

    /* Θ(N) */
    public QuickFindDS(int N){
        id = new int[N];
        for (int i = 0; i < N; i++){
            id[i] = i;
        }
    }

    /* 需要遍历数组 ⇒ Θ(N) */
    public void connect(int p, int q){
        int pid = id[p];
        int qid = id[q];
        for (int i = 0; i < id.length; i++){
            if (id[i] == pid){
                id[i] = qid;
            }
        }
    }

    /* Θ(1) */
    public boolean isConnected(int p, int q){
        return (id[p] == id[q]);
    }
}
```

N = 不相交集合数据结构中的元素数量

| 实现方式       | 构造函数                                                                                      | connect | isConnected |
| ---------- | ----------------------------------------------------------------------------------------- | ------- | ----------- |
| ListOfSets | Θ(N)[¹](https://cs61b-2.gitbook.io/cs61b-textbook/14.-disjoint-sets/14.2-quick-find#note) | O(N)    | O(N)        |
| QuickFind  | Θ(N)                                                                                      | Θ(N)    | Θ(1)        |

---
### 注释

1. 虽然未详细讨论，但初始化创建N个独立集合的时间复杂度为Θ(N) [↩](https://joshhug.gitbooks.io/hug61b/content/chap9/chap92.html#reffn_1)
