
# 6. 数组

---

迄今为止，我们已经掌握了如何利用递归类定义来创建可扩展的列表类，包括 `IntList`、`SLList` 和 `DLList`。在接下来的两章中，我们将探讨如何利用数组构建列表类。

本章假定您已具备数组的基本知识，并非旨在提供全面的语法指南。


---

## 数组基础

构建能够存储信息的列表需要某种内存分配机制。此前我们已经通过变量声明和类实例化获得内存空间：

- `int x;` 创建一个存储整数的32位内存单元
- `Walrus w1;` 创建一个存储海象对象引用的64位内存单元
- `Walrus w2 = new Walrus(30, 5.6);` 总共创建三个内存单元：存储引用的64位单元、存储尺寸的32位单元、存储象牙尺寸的64位单元

数组是一种特殊对象，其特点包括：

- 固定长度N
- 包含N个连续编号（0至N-1）的同类型内存单元
- 通过方括号索引访问元素（如 `A[i]`）
- 无类方法特性

---

## 数组创建

Java提供三种数组创建方式（[可视化演示](http://pythontutor.com/iframe-embed.html#code=public%20class%20ArrayCreationDemo%20%7B%0A%20%20public%20static%20void%20main\(String%5B%5D%20args%29%20%7B%0A%20%20%20%20int%5B%5D%20x%3B%0A%20%20%20%20int%5B%5D%20y%3B%0A%20%20%20%20x%20%3D%20new%20int%5B3%5D%3B%0A%20%20%20%20y%20%3D%20new%20int%5B%5D%7B1,%202,%203,%204,%205%7D%3B%0A%20%20%20%20int%5B%5D%20z%20%3D%20%7B9,%2010,%2011,%2012,%2013%7D%3B%0A%09%7D%0A%7D&codeDivHeight=400&codeDivWidth=350&cumulative=false&curInstr=0&heapPrimitives=false&origin=opt-frontend.js&py=java&rawInputLstJSON=%5B%5D&textReferences=false)）：

1. **显式长度声明**  
   `x = new int[3];`  
   创建长度为3的整型数组，所有元素初始化为0

2. **直接值初始化**  
   `y = new int[]{1, 2, 3, 4, 5};`  
   根据元素数量自动确定长度（本例为5）

3. **简化声明初始化**  
   `int[] z = {9, 10, 11, 12, 13};`  
   声明时专用语法，效果等同第二种方式

---

## 数组操作

以下代码演示数组核心操作（[交互演示](https://goo.gl/bertuh)）：

```java
int[] z = null;
int[] x, y;

x = new int[]{1, 2, 3, 4, 5};
y = x; // 引用赋值
x = new int[]{-1, 2, 5, 4, 99};
y = new int[3];
z = new int[0]; // 空数组
int xL = x.length; // 获取长度

String[] s = new String[6];
s[4] = "ketchup"; // 元素赋值
s[x[3] - x[1]] = "muffins"; // 动态索引

int[] b = {9, 10, 11};
System.arraycopy(b, 0, x, 3, 2); // 高效数组拷贝
```

**数组拷贝方法参数说明**：
- 源数组
- 源起始位置
- 目标数组
- 目标起始位置
- 拷贝元素数量

**注意**：Java数组在运行时进行边界检查，越界访问会抛出 `ArrayIndexOutOfBoundsException`（[示例演示](https://goo.gl/YHufJ6)）。

---

## 多维数组

Java多维数组本质是"数组的数组"（[可视化](http://goo.gl/VS4cOK)）：

```java
int[][] pascalsTriangle;
pascalsTriangle = new int[4][]; // 声明行数
pascalsTriangle[0] = new int[]{1}; // 动态分配列

int[][] matrix = new int[4][4]; // 标准矩阵
int[][] pascalAgain = {{1}, {1,1}, {1,2,1}, {1,3,3,1}}; // 简化初始化
```

**对象关系说明**：
- 多维数组元素是引用类型
- 浅拷贝与深拷贝的区别（[练习答案](http://goo.gl/fCZ9Dr)）

---

## 数组与类的对比

| 特性                | 数组                     | 类                  |
|---------------------|--------------------------|---------------------|
| 内存单元访问方式    | 数字索引 `[]`            | 具名字段 `.`        |
| 元素类型            | 必须统一                 | 可异构              |
| 运行时动态访问      | 支持                     | 需反射机制（不推荐）|

**重要限制**：
- 数组支持运行时动态索引，类字段访问需编译时确定
- 反射API虽可实现动态字段访问，但破坏封装性（[文档参考](https://docs.oracle.com/javase/tutorial/reflect/member/fieldValues.html)）

---

## 附录：Java数组特性

相较于其他语言：
- 无切片语法（如Python）
- 长度不可变（如Ruby）
- 无内置方法（如JavaScript）
- 严格类型约束（不同于Python）
