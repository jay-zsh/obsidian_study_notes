# 19.7 练习题

---

## 1. 综合题

(a) 判断正误：当添加键值对导致负载因子大于或等于指定最大负载因子时，将触发扩容。

**答案 Q1(a)**  
**错误**。仅当添加新键值对会导致负载因子**超过**指定最大负载因子时才会触发扩容。当负载因子等于最大负载因子时不会触发扩容。

(b) 判断正误：`hashCode()` 函数的返回类型可以多样化。

**答案 Q1(b)**  
**错误**。在 Java 中，`hashCode()` 函数**必须**返回 `int` 类型作为哈希值。

---

## 2. hashCode() 分析

为了确保哈希码的有效性，等价对象（即 `.equals()` 返回 `true`）必须返回相同的哈希码。若对象未显式覆盖 `hashCode()` 方法，将继承 Object 类的方法（返回对象内存地址）。

以下是四个可能的 Integer 类 `hashCode()` 实现。假设 `intValue()` 返回 Integer 对象表示的整数值。请判断每个实现的合法性。若合法，指出其缺陷；若不合法，说明原因。

问题 (a)

```java
public int hashCode() {
    return -1;
}
```

**答案 Q2(a)**  
合法。该哈希函数对等价的 Integer 对象返回相同哈希码。但此实现极差，因为哈希冲突频率为 100%。

问题 (b)

```java
public int hashCode() {
    return intValue() * intValue();
}
```

**答案 Q2(b)**  
合法。等价对象返回相同哈希码，但绝对值相同的整数会产生冲突（例如 5 和 -5）。更优方案是直接返回 `intValue()`。

问题 (c)

```java
public int hashCode() {
    Random rand = new Random();
    return rand.nextInt();
}
```

**答案 Q2(c)**  
不合法。同一 Integer 对象多次调用 `hashCode()` 会返回不同结果。

问题 (d)

```java
public int hashCode() {
    return super.hashCode();
}
```

**答案 Q2(d)**  
不合法。该实现返回对象内存地址，导致等价对象（不同内存位置）返回不同哈希码。

---

## 3. 哈希与扩容实践

给定以下 `hashCode()` 实现，使用外部链式法处理下列条目（首条已插入）。假设负载因子为 1，初始数组大小为 4，采用倍增扩容策略。必要时可扩展数组。

```java
/** 若单词首字母为 'a' 返回 0，'b' 返回 1，以此类推 */
public int hashCode() {
    return word.charAt(0) - 'a';
}
```

待插入条目：
```java
["apple", "cherry", "fig", "guava", "durian", "apricot", "banana"]
```

**答案 Q3**  
插入 `guava` 后的哈希表状态：  
![[1b7657a1d8e3b79263e33555769ed3d2_MD5.jpg]]

插入 `durian` 后的哈希表状态：  
![[2c52fc17bccc2ddbb6c3ab659d1e7997_MD5.jpg]]

全部插入完成后的哈希表状态：  
![[896ba49abd4c341c448c00cf71e27cbe_MD5.jpg]]

---
