# 32.3 稳定性、适应性与优化

---

## 稳定性

如果等价元素的顺序被保留，则排序是稳定的。以下是一个稳定排序的示例。在按部分排序后，注意Bas、Jana、Jouni和Rosella的顺序与排序前相同。如果我们希望记录按部分排序，然后在每个部分内按名称排序，我们可以先按名称排序，然后按部分排序，如下所示。

![](PANG/6ac7ea8dd0dfe94f80b09a868d020023_MD5.jpg)

以下示例是一个不稳定排序。它可能非常烦人！如果我们希望记录按部分排序，然后在每个部分内按名称排序，我们不能像之前那样先按名称排序然后按部分排序。在不稳定排序后，之前的顺序没有被保留。

![](PANG/a25bbff0d0bde11938cd51bf91d730ef_MD5.jpg)

我们学过的排序中有哪些是稳定的？插入排序是稳定的！等价元素会越过它们的等价兄弟。归并排序是稳定的。堆排序不稳定。快速排序可以是稳定的，取决于其分区方案，但由于许多流行的分区方案（如Hoare）是不稳定的，因此不能假设其稳定性。

---

## 优化

适应性 - 一种自适应排序利用数组的现有顺序。例如插入排序、平滑排序和TimSort。

切换到插入排序 - 当子问题的大小达到15或更小时，使用插入排序。对于小规模输入，它非常非常快。

利用键集的限制 - 例如，如果键的数量是某个常数，我们可以通过应用三路快速排序来利用这一约束进行更快排序。

从快速排序切换 - 如果递归太深，切换到另一种类型的排序。