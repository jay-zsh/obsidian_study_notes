# 20.3 åŒ…å«ä¸é‡å¤é¡¹

---

## åŒ…å«

---

### ColoredNumberå¯¹è±¡çš„equals()æ–¹æ³•

å‡è®¾ColoredNumberçš„`equals()`æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼ˆå½“ä¸¤ä¸ªColoredNumberçš„numå€¼ç›¸åŒæ—¶è§†ä¸ºç›¸ç­‰ï¼‰ï¼š

```java
@Override
public boolean equals(Object o) {
   if (o instanceof ColoredNumber otherCn) {
       return this.num == otherCn.num;
   }
   return false;
}
```

---

### HashSetæ£€æŸ¥contains()çš„è¡Œä¸º

å‡è®¾ä½¿ç”¨ä¸Šè¿°equalsæ–¹æ³•ï¼ˆæ ¹æ®numå€¼åˆ¤æ–­ç›¸ç­‰æ€§ï¼‰ï¼š

```java
int N = 20;
HashSet<ColoredNumber> hs = new HashSet<>();
for (int i = 0; i < N; i += 1) {
    hs.add(new ColoredNumber(i));
}

ColoredNumber twelve = new ColoredNumber(12);
hs.contains(twelve); // è¿”å›true
```

**é¢„æœŸ**`contains`ä¼šè¿”å›ä»€ä¹ˆï¼Ÿ  
ç­”æ¡ˆï¼šâœ… é¢„æœŸè¿”å›true

---

### ä½¿ç”¨é»˜è®¤å“ˆå¸Œç æŸ¥æ‰¾å…ƒç´ 

å‡è®¾ä½¿ç”¨é»˜è®¤å“ˆå¸Œå‡½æ•°ï¼ˆåŸºäºå†…å­˜åœ°å€ï¼‰ï¼š

```java
int N = 20;
HashSet<ColoredNumber> hs = new HashSet<>();
for (int i = 0; i < N; i += 1) {
   hs.add(new ColoredNumber(i));
}

ColoredNumber twelve = new ColoredNumber(12);
hs.contains(twelve); // è¿”å›??
```

æ­¤æ—¶å“ˆå¸Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š  
![[PANG/284ffb715906959294a0e7ffddbe8705_MD5.jpg]]

**å®é™…**ä¼šè¿”å›ä»€ä¹ˆï¼Ÿ  
ç­”æ¡ˆï¼šâŒ å¯èƒ½è¿”å›falseï¼ˆå› å“ˆå¸Œæ¡¶ä½ç½®é”™è¯¯ï¼‰

**æ ¸å¿ƒé—®é¢˜**ï¼šè‹¥é»˜è®¤å“ˆå¸Œç åˆ†å¸ƒè‰¯å¥½ï¼Œä¸ºä½•ä»éœ€è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°ï¼Ÿ  
ç­”æ¡ˆï¼šâœï¸ å“ˆå¸Œä¸€è‡´æ€§åŸåˆ™è¦æ±‚ï¼šç›¸ç­‰å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸åŒå“ˆå¸Œç ï¼Œå¦åˆ™æ— æ³•ä¿è¯å“ˆå¸Œè¡¨æ­£ç¡®æ€§

---

## é‡å¤å€¼å¤„ç†

---

### é‡å†™equals()ä½†æœªé‡å†™hashCode()

å‡è®¾ä»…é‡å†™equalsæ–¹æ³•ï¼ˆæ¯”è¾ƒnumå€¼ï¼‰ï¼Œæœªé‡å†™hashCodeï¼š

![[PANG/000d41b49fed9393ffb0997911ebe88a_MD5.jpg]]

```java
ColoredNumber zero = new ColoredNumber(0);
hs.add(zero); // æ˜¯å¦ä¼šå‡ºç°é‡å¤é›¶å€¼ï¼Ÿ
```

å¯èƒ½å‘ç”Ÿçš„æƒ…å†µï¼š  
1ï¸âƒ£ é›¶å€¼å­˜å…¥é›¶å·æ¡¶  
2ï¸âƒ£ é›¶å€¼å­˜å…¥ä¸€å·æ¡¶  
3ï¸âƒ£ é›¶å€¼å­˜å…¥å…¶ä»–æ¡¶  
4ï¸âƒ£ ä¸ä¼šäº§ç”Ÿé‡å¤é›¶å€¼  

ç­”æ¡ˆï¼šğŸ“¦ å¯èƒ½å­˜å…¥å…¶ä»–æ¡¶ä½å¯¼è‡´é‡å¤ï¼ˆé€‰é¡¹3ï¼‰

---

## æ ¸å¿ƒç»“è®ºï¼šequals()ä¸hashCode()

åŸºæœ¬åŸåˆ™ï¼šè‹¥ç±»é‡å†™equals()ï¼Œå¿…é¡»ä¸€è‡´æ€§é‡å†™hashCode()

* ç›¸ç­‰å¯¹è±¡å¿…é¡»å§‹ç»ˆå…·æœ‰ç›¸åŒå“ˆå¸Œç 

è¿ååæœï¼š  
âš ï¸ contains()å¯èƒ½æ— æ³•å®šä½å¯¹è±¡  
âš ï¸ add()å¯èƒ½äº§ç”Ÿé‡å¤å€¼

æŠ€æœ¯è§„èŒƒï¼š  
```java
// æ­£ç¡®å®ç°æ¨¡æ¿
@Override
public int hashCode() {
    return Objects.hash(num); // ä½¿ç”¨ç›¸åŒç‰¹å¾é‡è®¡ç®—å“ˆå¸Œ
}
```