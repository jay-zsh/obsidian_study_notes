# 16.4 二叉搜索树操作

---

### 搜索

在二叉搜索树中进行搜索时，我们利用其结构性特征实现二分查找。由于BST属性保证了左子树元素均小于当前节点，右子树元素均大于当前节点，我们可以从根节点开始递归比较：

1. 若目标值等于当前节点值，直接返回
2. 若目标值小于当前节点值，转向左子树
3. 若目标值大于当前节点值，转向右子树
4. 抵达空节点时表示查找失败

```java
static BST find(BST T, Key sk) {
   if (T == null)
      return null;
   if (sk.equals(T.key))
      return T;
   else if (sk ≺ T.key)
      return find(T.left, sk);
   else
      return find(T.right, sk);
}
```

对于树高为$h$的平衡树，时间复杂度为$O(\log n)$。

---

### 插入

插入操作始终在叶节点位置完成：

1. 执行搜索流程直至抵达空节点
2. 在最后访问节点的相应子节点位置创建新节点
3. 保持BST属性不变

```java
static BST insert(BST T, Key ik) {
  if (T == null)
    return new BST(ik);
  if (ik ≺ T.key)
    T.left = insert(T.left, ik);
  else if (ik ≻ T.key)
    T.right = insert(T.right, ik);
  return T;
}
```

---

### 删除

删除操作需根据子节点数量分情况处理：

#### 无子节点
直接删除节点，父节点对应指针置空，通过垃圾回收机制清除内存。

#### 单子节点
将父节点指针重定向至唯一子节点，保持BST结构完整性。

#### 双子节点（希巴德删除法）
1. 选择左子树最大节点或右子树最小节点作为替代者
2. 将替代节点值复制到目标节点
3. 递归删除原替代节点

以下为删除"dog"节点的候选替代方案示意图：
![](https://cs61b-2.gitbook.io/~gitbook/image?url=https%3A%2F%2F2316889115-files.gitbook.io%2F~%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FCLYj7ccqvV6l4Pt9R0w5%252Fuploads%252F8owv3DhVpUTJBRcfd2uI%252Fimage.png%3Falt%3Dmedia%26token%3D820d3ba3-92bb-460f-aa4c-fbf2e6d1eccd&width=768&dpr=4&quality=100&sign=a1d03a45&sv=2)

该算法通过选择左子树最大元素（如"cat"）或右子树最小元素（如"elf"）作为替代节点，完美保持BST属性。