# 21.2 堆结构

---

### 堆的引入
二叉搜索树虽然能实现$O(\log N)$的搜索操作，但通过调整结构约束可以进一步提升效率。我们定义**最小堆**需要满足两个核心性质：
1. **最小堆性质**：任意节点的值 ≤ 其子节点的值
2. **完全二叉树性质**：最底层节点尽可能靠左排列

> 图示说明：绿色堆结构有效，红色结构违反上述原则

---

### 堆操作实现
优先队列ADT的三个核心操作在堆中的实现逻辑：

#### 添加元素(add)
1. 临时插入堆末尾
2. 通过"上浮"调整位置（当子节点值<父节点值时交换）
```java
public void add(Item x) {
    items[size++] = x;
    swim(size - 1);
}
```

#### 获取最小值(getSmallest)
直接返回根节点（最小堆性质保证根节点为最小值）
```java
public Item getSmallest() {
    return items[0];
}
```

#### 移除最小值(removeSmallest)
1. 将末尾元素交换至根节点
2. 通过"下沉"调整位置（当父节点值>子节点值时，与较小子节点交换）
```java
public Item removeSmallest() {
    Item min = items[0];
    swap(0, --size);
    sink(0);
    return min;
}
```

**习题13.2.1**：用伪代码描述各方法实现逻辑

---

### 时间复杂度分析
| 操作          | 时间复杂度 |
|---------------|------------|
| add           | $O(\log N)$|
| getSmallest   | $O(1)$     |
| removeSmallest| $O(\log N)$|

**关键特性**：
- 数组实现的堆比指针实现的树节省约2/3内存
- 动态扩容时的均摊分析不影响渐进复杂度

---

### 树的表示方法对比
| 方法类型       | 特点                      | 适用场景         |
|----------------|---------------------------|------------------|
| 指针表示法     | 直观但内存占用大          | 通用树结构       |
| 数组表示法     | 内存紧凑，适合完全二叉树  | 堆结构实现       |
| 兄弟节点表示法 | 节省子节点指针空间        | 多叉树结构       |

**最佳实践**：堆结构推荐使用数组表示法（方法3），因其：
- 完全二叉树性质无空间浪费
- 父子节点关系可通过算术计算定位
